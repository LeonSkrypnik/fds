# Vault (MVP)

Это минимальный рабочий прототип из `detqils.md`: один файл-контейнер `vault.dat` (формат `VLT1`), где **заголовок + метаданные** хранятся в AEAD-шифровании, а содержимое файлов пишется чанками (1 MiB), каждый чанк отдельно шифруется.

## Важно про «как нормальная папка в Проводнике»
Без драйвера/системного компонента нельзя сделать так, чтобы *другие программы* видели контейнер как обычную папку/диск. Вместо этого делается **встроенный файловый менеджер** (в этом MVP — CLI-команды `ls/mkdir/import/export`).

## Сборка в один `.exe`
### Вариант A: локально (если есть Rust)
1) Откройте терминал в папке `vault/`.
2) Соберите релиз:

```bash
cargo build --release
```

На Windows итоговый файл будет здесь:

```text
target\release\vault.exe
```

### Вариант B: GitHub Actions (без сборки на вашем ПК)
В репозитории уже добавлен workflow: `.github/workflows/build-windows.yml`.

**Шаги (все в браузере):**
1) Создайте репозиторий на GitHub и загрузите туда этот проект (папки `vault/` и `.github/` должны попасть в репозиторий).
2) Откройте вкладку **Actions**.
3) Слева выберите workflow **build-windows**.
4) Нажмите **Run workflow**.
5) Дождитесь, пока job `build-windows-x64` станет зелёным.
6) Откройте выполненный запуск и внизу в разделе **Artifacts** скачайте `vault-windows-x64`.
7) Внутри архива будет `vault.exe` (и `README.md` рядом).

**Важно:** это всё равно компиляция, просто она происходит на сервере GitHub, а не у вас.

Это один исполняемый файл; дополнительных DLL от проекта не создаётся, но Windows может требовать системные рантаймы (в зависимости от окружения).

## Быстрый старт
Создать контейнер:

```bash
vault.exe init --path vault.dat --password "MyStrongPassword" --m-cost-kib 131072 --t-cost 3
```

Показать корень (id=1):

```bash
vault.exe ls --path vault.dat --password "MyStrongPassword" --dir-id 1
```

Создать папку:

```bash
vault.exe mkdir --path vault.dat --password "MyStrongPassword" --parent-id 1 --name Docs
```

Импортировать файл с диска в контейнер:

```bash
vault.exe import --path vault.dat --password "MyStrongPassword" --os-path "C:\\tmp\\a.txt" --parent-id 1
```

Экспортировать файл по его `id`:

```bash
vault.exe export --path vault.dat --password "MyStrongPassword" --file-id 2 --out-path "C:\\tmp\\a_out.txt"
```

## Что ещё нужно для «нормального приложения-папки»
- GUI (дерево папок/список файлов/просмотр текста/картинок)
- транзакции/журналирование и A/B слоты метаданных
- freelist для повторного использования места
- авто-лок по таймеру, очистка памяти, безопасные временные файлы